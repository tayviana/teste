<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="voltar()">
        <ion-icon name="arrow-back"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Meu Plano Alimentar</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <!-- SELE√á√ÉO DE BIOTIPO -->
  <div class="selection-section">
    <h2>üéØ Escolha Seu Plano Alimentar</h2>
    <p class="subtitle">Selecione conforme seu biotipo</p>

    <div class="biotipo-cards">
      <!-- ECTOMORFO -->
      <div 
        class="biotipo-card" 
        [class.selected]="biotipoSelecionado === 'ECTOMORFO'"
        (click)="selecionarBiotipo('ECTOMORFO')">
        <div class="card-icon">üí™</div>
        <div class="card-content">
          <h3>Ectomorfo</h3>
          <p class="card-subtitle">Ganho de Massa</p>
          <div class="card-details">
            <p><strong>Meta:</strong> 2.800 kcal</p>
            <p>Alto teor cal√≥rico</p>
            <small>Ideal para ganhar massa muscular</small>
          </div>
        </div>
        <div class="selected-indicator" *ngIf="biotipoSelecionado === 'ECTOMORFO'">‚úì</div>
      </div>

      <!-- MESOMORFO -->
      <div 
        class="biotipo-card" 
        [class.selected]="biotipoSelecionado === 'MESOMORFO'"
        (click)="selecionarBiotipo('MESOMORFO')">
        <div class="card-icon">‚öñÔ∏è</div>
        <div class="card-content">
          <h3>Mesomorfo</h3>
          <p class="card-subtitle">Manuten√ß√£o</p>
          <div class="card-details">
            <p><strong>Meta:</strong> 2.200 kcal</p>
            <p>Equil√≠brio perfeito</p>
            <small>Manter e definir m√∫sculos</small>
          </div>
        </div>
        <div class="selected-indicator" *ngIf="biotipoSelecionado === 'MESOMORFO'">‚úì</div>
      </div>

      <!-- ENDOMORFO -->
      <div 
        class="biotipo-card" 
        [class.selected]="biotipoSelecionado === 'ENDOMORFO'"
        (click)="selecionarBiotipo('ENDOMORFO')">
        <div class="card-icon">üî•</div>
        <div class="card-content">
          <h3>Endomorfo</h3>
          <p class="card-subtitle">Perda de Gordura</p>
          <div class="card-details">
            <p><strong>Meta:</strong> 1.800 kcal</p>
            <p>Baixo teor cal√≥rico</p>
            <small>Foco em emagrecimento</small>
          </div>
        </div>
        <div class="selected-indicator" *ngIf="biotipoSelecionado === 'ENDOMORFO'">‚úì</div>
      </div>
    </div>
  </div>

  <!-- SELE√á√ÉO DE DIA -->
  <div class="selection-section" *ngIf="biotipoSelecionado">
    <h3>üìÖ Selecione o Dia da Semana</h3>
    
    <div class="dias-buttons">
      <ion-button 
        *ngFor="let dia of ['SEGUNDA', 'TERCA', 'QUARTA', 'QUINTA', 'SEXTA', 'SABADO', 'DOMINGO']"
        [fill]="diaSelecionado === dia ? 'solid' : 'outline'"
        (click)="selecionarDia(dia)"
        size="small">
        {{ getDiaDisplay(dia) }}
      </ion-button>
    </div>
  </div>

  <!-- RESUMO DO DIA -->
  <ion-card *ngIf="planoHoje && planoHoje.refeicoes.length > 0" class="resumo-card">
    <ion-card-header>
      <ion-card-title>üìä Resumo do Dia - {{ dietaAtual?.nome }}</ion-card-title>
      <ion-card-subtitle>{{ dataSelecionada | date:'dd/MM/yyyy' }} ‚Ä¢ {{ getDiaDisplay(diaSelecionado) }}</ion-card-subtitle>
    </ion-card-header>
    
    <ion-card-content>
      <div class="resumo-grid">
        <div class="resumo-item">
          <div class="resumo-valor">{{ planoHoje.totalCalorias }}</div>
          <div class="resumo-label">CALORIAS</div>
          <div class="resumo-meta">Meta: {{ planoHoje.metaCalorias }} kcal</div>
        </div>
        
        <div class="resumo-item">
          <div class="resumo-valor">{{ planoHoje.totalProteinas }}g</div>
          <div class="resumo-label">PROTE√çNAS</div>
        </div>
        
        <div class="resumo-item">
          <div class="resumo-valor">{{ planoHoje.totalCarboidratos }}g</div>
          <div class="resumo-label">CARBOIDRATOS</div>
        </div>
        
        <div class="resumo-item">
          <div class="resumo-valor">{{ planoHoje.totalGorduras }}g</div>
          <div class="resumo-label">GORDURAS</div>
        </div>
      </div>
    </ion-card-content>
  </ion-card>

  <!-- LISTA DE REFEI√á√ïES -->
  <div *ngIf="planoHoje && planoHoje.refeicoes.length > 0" class="refeicoes-section">
    <h3>üçΩÔ∏è Refei√ß√µes do Dia ({{ planoHoje.refeicoes.length }})</h3>
    
    <div class="refeicoes-list">
      <ion-card *ngFor="let refeicao of planoHoje.refeicoes" class="refeicao-card">
        <ion-card-header>
          <ion-card-title>{{ refeicao.nome }}</ion-card-title>
          <ion-card-subtitle>
            <span class="refeicao-tipo">{{ refeicao.tipo }}</span> ‚Ä¢ 
            <span class="refeicao-horario">{{ refeicao.horario }}</span>
          </ion-card-subtitle>
        </ion-card-header>
        
        <ion-card-content>
          <div class="macros-info">
            <span class="macro-item">{{ refeicao.calorias }} kcal</span>
            <span class="macro-item">{{ refeicao.proteinas }}g P</span>
            <span class="macro-item">{{ refeicao.carboidratos }}g C</span>
            <span class="macro-item">{{ refeicao.gorduras }}g G</span>
          </div>
          
          <p class="observacoes" *ngIf="refeicao.observacoes">
            {{ refeicao.observacoes }}
          </p>
        </ion-card-content>
      </ion-card>
    </div>
  </div>

  <!-- MENSAGEM QUANDO N√ÉO H√Å REFEI√á√ïES -->
  <div *ngIf="!planoHoje || planoHoje.refeicoes.length === 0" class="empty-state">
    <div class="empty-icon">üçΩÔ∏è</div>
    <h3>Nenhuma refei√ß√£o encontrada</h3>
    <p>Selecione um biotipo e um dia da semana para ver o plano alimentar</p>
  </div>

  <!-- LOADING -->
  <div *ngIf="carregando" class="loading">
    <ion-spinner></ion-spinner>
    <p>Carregando plano alimentar...</p>
  </div>
</ion-content>